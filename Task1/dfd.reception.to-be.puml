@startuml
title DFD: Приём пациентов - To-Be версия

actor Пациент as Patient

rectangle "Портал / Мобильное приложение\n(Личный кабинет пациента)" as Portal
rectangle "Ресепшен\n(Сервис записи)" as Reception
database "Централизованное защищённое хранилище\n(PostgreSQL + Шифрование AES-256)" as SecureDB
rectangle "Медицинские специалисты\n(Доступ по RBAC/ABAC)" as MedSpecialists
rectangle "Аудит и мониторинг доступа\n(Журналирование, Алерты)" as AuditSystem

Patient --> Portal : Регистрация / Запись на приём\n(Данные шифруются при передаче TLS)
Portal --> SecureDB : Сохранение данных пациента\n(Данные тегируются PII, MED_DATA)
Portal --> Reception : Оповещение о новой записи\n(Только с нужными данными)

Reception --> SecureDB : Запись данных приёма\n(Актуализация и расширение данных)
Reception --> MedSpecialists : Предоставление доступа к данным\n(С разграничением доступа)

MedSpecialists --> SecureDB : Запрос медкарт и данных анализов\n(Доступ строго по ролям)

SecureDB --> AuditSystem : Отправка логов доступа и изменений
AuditSystem --> SecurityTeam : Оповещение о подозрительных действиях

note right of SecureDB
  Все данные хранятся зашифрованными.\n
  Реализован механизм тегирования и классификации данных.\n
  Автоматическое удаление данных по запросу клиента.\n
  Разграничение доступа по ролям и атрибутам.\n
  Внедрён аудит доступа и мониторинг безопасности.
end note

note left of Portal
  Пациент видит только свои данные.\n
  Возможность подтверждения / отмены записи.\n
  Уведомления через мобильное приложение.
end note

note bottom of AuditSystem
  Централизованный сбор логов доступа и действий.\n
  Реализация оповещений и отчётов о безопасности.
end note

@enduml
